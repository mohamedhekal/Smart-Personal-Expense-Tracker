# Msarefy App – Full Stack (Backend + Frontend)

A personal finance management app with a Laravel backend and a Vite + React frontend. This README provides a complete guide in English and Arabic.

---

## English

### Overview
- Backend: Laravel (PHP) REST API, SQLite database by default
- Frontend: React (Vite), communicates with the API
- Use cases: Salaries, expenses, categories, goals, gold purchases/sales, freelance revenues/payments, reminders, WhatsApp subscriptions, notifications, settings, and activity logs

### Project Structure
```
msarefy-ios-app/
  backend/   # Laravel API (PHP)
  frontend/  # React (Vite) web app
```

### Prerequisites
- PHP 8.2+
- Composer 2+
- Node.js 18+ and npm 9+
- SQLite (bundled with PHP; no server needed)

### Quick Start
1) Backend API
```
cd backend
cp .env.example .env
composer install
php artisan key:generate
# Ensure SQLite is configured in .env
# DB_CONNECTION=sqlite
# DB_DATABASE=./database/database.sqlite
# Create the SQLite file if it doesn't exist
php -r "file_exists('database/database.sqlite') || touch('database/database.sqlite');"
php artisan migrate --seed
php artisan serve --host=127.0.0.1 --port=8000
```
API will be available at `http://127.0.0.1:8000` (base path `/api`).

2) Frontend App
```
cd ../frontend
cp .env.example .env 2>/dev/null || true
# Set API base URL in .env
# VITE_API_BASE_URL=http://127.0.0.1:8000/api
npm install
npm run dev
```
Frontend will start on the printed Vite dev URL (usually `http://127.0.0.1:5173`).

### Environment Configuration
- Backend (`backend/.env`):
  - `APP_KEY` generated by `php artisan key:generate`
  - `DB_CONNECTION=sqlite`
  - `DB_DATABASE=./database/database.sqlite`
- Frontend (`frontend/.env`):
  - `VITE_API_BASE_URL=http://127.0.0.1:8000/api`

### Useful Commands
- Backend
  - Install deps: `composer install`
  - Migrate + seed: `php artisan migrate --seed`
  - Start server: `php artisan serve`
  - Run tests: `./vendor/bin/phpunit` or `php artisan test`
- Frontend
  - Install deps: `npm install`
  - Dev server: `npm run dev`
  - Build: `npm run build`
  - Preview build: `npm run preview`

### Notes on Data
- Default database is SQLite at `backend/database/database.sqlite`.
- Existing migrations and seeders cover: users, tokens, salaries, expenses, categories, goals, gold, freelance, reminders, WhatsApp subscriptions, notifications, settings, and activity logs.

### Troubleshooting
- 404 on API: Confirm backend is running on `127.0.0.1:8000` and `VITE_API_BASE_URL` matches.
- Database errors: Ensure SQLite file exists and `.env` points to it. Re-run `php artisan migrate --seed`.
- CORS: `backend/config/cors.php` is configured by default (Laravel). If needed, adjust allowed origins to your dev URL.

---

## العربية

### نظرة عامة
- الخادم (Backend): Laravel (PHP) REST API وقاعدة بيانات SQLite افتراضيًا
- الواجهة (Frontend): React (Vite) وتتواصل مع واجهة البرمجة API
- حالات الاستخدام: الرواتب، المصروفات، التصنيفات، الأهداف، شراء/بيع الذهب، إيرادات/دفعات العمل الحر، التذكيرات، اشتراكات واتساب، الإشعارات، الإعدادات، وسجل الأنشطة

### هيكل المشروع
```
msarefy-ios-app/
  backend/   # واجهة برمجة Laravel
  frontend/  # واجهة React (Vite)
```

### المتطلبات
- PHP 8.2+
- Composer 2+
- Node.js 18+ و npm 9+
- SQLite (مرفق مع PHP؛ لا يحتاج خادم منفصل)

### البدء السريع
1) واجهة البرمجة (Backend)
```
cd backend
cp .env.example .env
composer install
php artisan key:generate
# تأكد من إعداد SQLite في ملف .env
# DB_CONNECTION=sqlite
# DB_DATABASE=./database/database.sqlite
# أنشئ ملف قاعدة البيانات إن لم يكن موجودًا
php -r "file_exists('database/database.sqlite') || touch('database/database.sqlite');"
php artisan migrate --seed
php artisan serve --host=127.0.0.1 --port=8000
```
ستكون الواجهة البرمجية على `http://127.0.0.1:8000` (المسار الأساسي `/api`).

2) الواجهة الأمامية (Frontend)
```
cd ../frontend
cp .env.example .env 2>/dev/null || true
# عيّن رابط واجهة البرمجة في .env
# VITE_API_BASE_URL=http://127.0.0.1:8000/api
npm install
npm run dev
```
عادةً ستعمل الواجهة على `http://127.0.0.1:5173` (حسب مخرجات Vite).

### ضبط المتغيرات
- الخادم (`backend/.env`):
  - `APP_KEY` يتم توليده بـ `php artisan key:generate`
  - `DB_CONNECTION=sqlite`
  - `DB_DATABASE=./database/database.sqlite`
- الواجهة (`frontend/.env`):
  - `VITE_API_BASE_URL=http://127.0.0.1:8000/api`

### أوامر مفيدة
- الخادم
  - تثبيت الاعتمادات: `composer install`
  - الهجرة + البيانات التجريبية: `php artisan migrate --seed`
  - تشغيل الخادم: `php artisan serve`
  - الاختبارات: `./vendor/bin/phpunit` أو `php artisan test`
- الواجهة
  - تثبيت الاعتمادات: `npm install`
  - وضع التطوير: `npm run dev`
  - بناء الإنتاج: `npm run build`
  - معاينة البناء: `npm run preview`

### ملاحظات البيانات
- قاعدة البيانات الافتراضية: `backend/database/database.sqlite`.
- توجد هجرات ومُعبّئات (seeders) للكيانات: المستخدمون، الرموز، الرواتب، المصروفات، التصنيفات، الأهداف، الذهب، العمل الحر، التذكيرات، اشتراكات واتساب، الإشعارات، الإعدادات، وسجل الأنشطة.

### استكشاف الأخطاء
- خطأ 404 في API: تأكد أن الخادم يعمل على `127.0.0.1:8000` وأن `VITE_API_BASE_URL` مطابق.
- أخطاء قاعدة البيانات: تأكد من وجود ملف SQLite وأن `.env` يشير إليه. أعد تشغيل `php artisan migrate --seed`.
- CORS: الإعدادات في `backend/config/cors.php`. عدّل مصادر الوصول إذا لزم على عنوان تطويرك.

---

### License
This project is for personal use. Add a proper license if you plan to distribute.
